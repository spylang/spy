<!DOCTYPE html>
<html lang="en">
<head>
    <title>SPy playground</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="https://pyscript.net/releases/2025.2.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2025.2.1/core.js"></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

    <!-- Codemirror Interactive Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/codemirror.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/python/python.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css" >

    <!-- Custom playground styles -->
    <link rel="stylesheet" href="style.css">

    <!-- PyScript lifecycle event logging -->
    <script>
        console.log('[PyScript] Page loaded, waiting for PyScript initialization...');

        // Fired when PyScript finds a script/element and interpreter is ready
        addEventListener("py:ready", (event) => {
            console.log('[PyScript] py:ready - Interpreter bootstrapped, about to execute:', event.target);
            console.time('[PyScript] Execution time');

            // Remove loading indicator when PyScript is ready
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator) {
                loadingIndicator.remove();
            }
        });

        // Fired when a specific script/element finishes executing
        addEventListener("py:done", (event) => {
            console.timeEnd('[PyScript] Execution time');
            console.log('[PyScript] py:done - Script execution completed:', event.target);
        });

        // Fired when ALL scripts on the page are done
        addEventListener("py:all-done", () => {
            console.log('[PyScript] py:all-done - All scripts finished, app ready!');
        });

        // Error event
        addEventListener("py:error", (event) => {
            console.error('[PyScript] py:error - Error occurred:', event.detail);
        });
    </script>

</head>
<body>
    <!-- Loading indicator - shown until PyScript is ready -->
    <div id="loading-indicator">
        <img src="assets/disguised-face.svg" alt="Loading...">
        <h2>Loading SPy Playground</h2>
        <p>Initializing PyScript and SPy compiler...</p>
    </div>

    <script type="py" src="main.py" config="pyscript.toml" terminal>
    </script>

</body>
</html>